# üì¥ Offline-First: –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

## –ß—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å?

### ‚ùå –ë—ã–ª–æ (–º–µ–¥–ª–µ–Ω–Ω–æ):
```
App ‚Üí Supabase ‚Üí App
       ‚¨ÜÔ∏è ‚¨áÔ∏è
   (–ò–Ω—Ç–µ—Ä–Ω–µ—Ç –Ω—É–∂–µ–Ω)
```

### ‚úÖ –°—Ç–∞–ª–æ (–º–≥–Ω–æ–≤–µ–Ω–Ω–æ):
```
App ‚Üí –õ–æ–∫–∞–ª—å–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ ‚Üí App
     (–†–∞–±–æ—Ç–∞–µ—Ç –æ—Ñ–ª–∞–π–Ω!)

Supabase (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):
- –¢–æ–ª—å–∫–æ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
- –†–µ–∑–µ—Ä–≤–Ω—ã–µ –∫–æ–ø–∏–∏
```

---

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### 1. –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏

```tsx
import { useLocalTransactions } from '@/hooks/useLocalTransactions';

function MyComponent() {
  const { 
    transactions,     // –í—Å–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ (–º–≥–Ω–æ–≤–µ–Ω–Ω–æ)
    addTransaction,   // –î–æ–±–∞–≤–∏—Ç—å (–º–≥–Ω–æ–≤–µ–Ω–Ω–æ)
    updateTransaction,// –û–±–Ω–æ–≤–∏—Ç—å (–º–≥–Ω–æ–≤–µ–Ω–Ω–æ)
    removeTransaction,// –£–¥–∞–ª–∏—Ç—å (–º–≥–Ω–æ–≤–µ–Ω–Ω–æ)
  } = useLocalTransactions(userId);

  // –î–æ–±–∞–≤–∏—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é
  await addTransaction({
    amount: 1000,
    category_id: 'cat_1',
    description: '–ü—Ä–æ–¥—É–∫—Ç—ã',
    date: new Date().toISOString(),
  });
  // ‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–æ –º–≥–Ω–æ–≤–µ–Ω–Ω–æ, –æ—Ñ–ª–∞–π–Ω —Ä–∞–±–æ—Ç–∞–µ—Ç!
}
```

### 2. –ö–∞—Ç–µ–≥–æ—Ä–∏–∏

```tsx
import { useLocalCategories } from '@/hooks/useLocalCategories';

const { 
  categories,
  addCategory,
  updateCategory,
  removeCategory,
} = useLocalCategories(userId);
```

### 3. –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏

```tsx
import { SyncIndicator } from '@/components/SyncIndicator';

<SyncIndicator />
// –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç:
// - ‚úÖ –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–æ
// - üîÑ –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è...
// - ‚ö†Ô∏è 5 –Ω–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–æ
```

---

## –ß—Ç–æ —Ö—Ä–∞–Ω–∏—Ç—Å—è –≥–¥–µ?

### üì± –ù–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ (–º–≥–Ω–æ–≤–µ–Ω–Ω–æ):
- –í—Å–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
- –í—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
- –í—Å–µ –¥–æ—Ö–æ–¥—ã
- –ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π

### ‚òÅÔ∏è –í Supabase (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):
- –£—á–µ—Ç–Ω—ã–µ –∑–∞–ø–∏—Å–∏
- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ—Ñ–∏–ª—è
- –†–µ–∑–µ—Ä–≤–Ω—ã–µ –∫–æ–ø–∏–∏

---

## –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

### ‚ö°Ô∏è –°–∫–æ—Ä–æ—Å—Ç—å
- **–ë–µ–∑ –æ—Ñ–ª–∞–π–Ω–∞**: 200-1000ms –Ω–∞ –∑–∞–ø—Ä–æ—Å
- **–° –æ—Ñ–ª–∞–π–Ω–æ–º**: <1ms –Ω–∞ –∑–∞–ø—Ä–æ—Å
- **–†–∞–∑–Ω–∏—Ü–∞**: –≤ 200-1000 —Ä–∞–∑ –±—ã—Å—Ç—Ä–µ–µ!

### üì¥ –†–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞
- –ê–≤–∏–∞—Ä–µ–∂–∏–º - –û–ö
- –ü–ª–æ—Ö–∞—è —Å–µ—Ç—å - –û–ö
- –ù–µ—Ç –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞ - –û–ö

### üíæ –í–∞—à–∏ –¥–∞–Ω–Ω—ã–µ
- –•—Ä–∞–Ω—è—Ç—Å—è –Ω–∞ –≤–∞—à–µ–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ
- –ü–æ–ª–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å
- –ü—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç—å

---

## –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –∫–æ–¥

### –®–∞–≥ 1: –ó–∞–º–µ–Ω–∏—Ç—å Supabase –Ω–∞ Local

**–ë—ã–ª–æ:**
```tsx
const { data } = await supabase
  .from('transactions')
  .select('*');
```

**–°—Ç–∞–ª–æ:**
```tsx
const { transactions } = useLocalTransactions(userId);
```

### –®–∞–≥ 2: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ö—É–∫–∏

**–î–æ–±–∞–≤–ª–µ–Ω–∏–µ:**
```tsx
await addTransaction({ amount, category_id, description, date });
```

**–£–¥–∞–ª–µ–Ω–∏–µ:**
```tsx
await removeTransaction(id);
```

**–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ:**
```tsx
await updateTransaction(id, { amount: 2000 });
```

---

## –ú–∏–≥—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö

### –î–ª—è –Ω–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
–í—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏! üéâ

### –î–ª—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö (—Å –¥–∞–Ω–Ω—ã–º–∏ –≤ Supabase)

```tsx
import { migrateFromSupabase } from '@/utils/migration';

// –ü—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ
await migrateFromSupabase(userId);
// –ó–∞–≥—Ä—É–∑–∏—Ç –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ Supabase ‚Üí –õ–æ–∫–∞–ª—å–Ω–æ
```

---

## FAQ

### –ù—É–∂–µ–Ω –ª–∏ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç?
**–ù–µ—Ç!** –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–∞–±–æ—Ç–∞–µ—Ç –æ—Ñ–ª–∞–π–Ω.

### –ß—Ç–æ —Å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–µ–π?
–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è. –ú–æ–∂–Ω–æ –≤–∫–ª—é—á–∏—Ç—å –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö.

### –ß—Ç–æ –µ—Å–ª–∏ —É–¥–∞–ª—é –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ?
–õ–æ–∫–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –ø–æ—Ç–µ—Ä—è—é—Ç—Å—è. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –±—ç–∫–∞–ø—ã.

### –ö–∞–∫ –±—ç–∫–∞–ø–∏—Ç—å?
```tsx
import { exportAllData } from '@/utils/localStorage';
const backup = await exportAllData();
// –°–æ—Ö—Ä–∞–Ω–∏—Ç—å backup –≤ –æ–±–ª–∞–∫–æ –∏–ª–∏ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–µ–±–µ
```

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ –ª–∏?
–î–∞! –î–∞–Ω–Ω—ã–µ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω—ã iOS Keychain.

---

## –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

```tsx
import { getStorageStats } from '@/utils/localStorage';

const stats = await getStorageStats();
// {
//   transactions: 342,
//   categories: 18,
//   incomes: 67,
//   totalItems: 427,
//   pendingSync: 0
// }
```

---

## –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- **–ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è**: `OFFLINE-FIRST.md`
- **API Reference**: —Å–º. –≤ –∫–æ–¥–µ
- **–ü—Ä–∏–º–µ—Ä—ã**: —Å–º. hooks

---

**CrystalBudget —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç –º–æ–ª–Ω–∏–µ–Ω–æ—Å–Ω–æ –±—ã—Å—Ç—Ä–æ!** ‚ö°Ô∏è

–í—Å—è –º–∞–≥–∏—è - –≤ –ª–æ–∫–∞–ª—å–Ω–æ–º —Ö—Ä–∞–Ω–∏–ª–∏—â–µ üì±

