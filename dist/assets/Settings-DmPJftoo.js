import{c as w,k as be,i as ke,q as Ce,h as Se,r as m,s as i,j as e}from"./index-BczRz4ky.js";import{L as qe}from"./Layout-Cjs2lFUa.js";import{C as f,c as p,d as j,e as g,a as y,B as d}from"./crystal-icon-BR5-Rl_Z.js";import{L as x,I as v}from"./label-03Zcm6W0.js";import{S as Te,a as Me,b as Ue,d as Le,e as h,T as De}from"./select-DrkzBdXl.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fe=w("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X=w("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pe=w("Monitor",[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Re=w("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ee=w("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oe=w("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ie=w("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]),Ve=()=>{const ee=be(),{toast:t}=ke(),{theme:D,setTheme:F}=Ce(),{user:a}=Se(),[se,ae]=m.useState(localStorage.getItem("currency")||"RUB"),[I,B]=m.useState(""),[o,l]=m.useState(!1),[n,b]=m.useState(null),[Be,Ae]=m.useState(""),[S,A]=m.useState(""),[P,z]=m.useState([]),[q,R]=m.useState(""),[E,te]=m.useState([]),[_,W]=m.useState(""),[T,G]=m.useState(""),[M,J]=m.useState(""),[ie,H]=m.useState(!1),[re,V]=m.useState(""),[Y,$]=m.useState(!1);m.useEffect(()=>{a&&(le(),O(),K())},[a]);const le=async()=>{if(!a)return;const{data:s,error:r}=await i.from("profiles").select("full_name").eq("user_id",a.id).maybeSingle();!r&&s&&B(s.full_name||"")},K=async()=>{if(!a)return;const{data:s,error:r}=await i.from("telegram_users").select("telegram_username, telegram_first_name").eq("user_id",a.id).maybeSingle();!r&&s&&(H(!0),V(s.telegram_username||s.telegram_first_name||""))},O=async()=>{if(!a)return;const{data:s}=await i.from("families").select("*").eq("owner_id",a.id).maybeSingle();if(s){b(s),R(s.name||""),await U(s.id);return}const{data:r}=await i.from("family_members").select("family_id").eq("user_id",a.id).maybeSingle();if(r){const{data:c}=await i.from("families").select("*").eq("id",r.family_id).single();c&&(b(c),R(c.name||""),await U(c.id))}},U=async s=>{const{data:r}=await i.from("families").select("owner_id").eq("id",s).single(),c=[];if(r!=null&&r.owner_id){const{data:u}=await i.from("profiles").select("full_name").eq("user_id",r.owner_id).maybeSingle();c.push({user_id:r.owner_id,full_name:(u==null?void 0:u.full_name)||"Пользователь",is_owner:!0,joined_at:null})}const{data:N}=await i.from("family_members").select("user_id, joined_at").eq("family_id",s);if(N){const u=await Promise.all(N.map(async L=>{const{data:k}=await i.from("profiles").select("full_name").eq("user_id",L.user_id).maybeSingle();return{...L,full_name:(k==null?void 0:k.full_name)||"Пользователь",is_owner:!1}}));c.push(...u)}if(z(c),(n==null?void 0:n.owner_id)===(a==null?void 0:a.id)){const{data:u}=await i.from("family_invite_codes").select("*").eq("family_id",s).is("used_by",null).gt("expires_at",new Date().toISOString()).order("created_at",{ascending:!1});u&&te(u)}},ne=async()=>{if(!a)return;l(!0);const{data:s,error:r}=await i.from("families").insert({owner_id:a.id}).select().single();r?t({variant:"destructive",title:"Ошибка создания семьи",description:r.message}):(b(s),t({title:"Семья создана",description:"Теперь вы можете пригласить членов семьи"}),await O()),l(!1)},Z=async()=>{if(!a||!n)return;l(!0),await i.from("family_invite_codes").delete().eq("family_id",n.id).is("used_by",null);const s=Math.random().toString(36).substring(2,10).toUpperCase(),{error:r}=await i.from("family_invite_codes").insert({family_id:n.id,code:s,created_by:a.id});r?t({variant:"destructive",title:"Ошибка генерации кода",description:r.message}):(t({title:"Код сгенерирован",description:"Код действителен 5 минут и скопирован в буфер обмена"}),navigator.clipboard.writeText(s),await U(n.id)),l(!1)},ce=async()=>{if(!a||!n||n.owner_id!==a.id)return;l(!0);const{error:s}=await i.from("families").update({name:q}).eq("id",n.id);s?t({variant:"destructive",title:"Ошибка обновления",description:s.message}):(b({...n,name:q}),t({title:"Название обновлено",description:"Название семьи успешно изменено"})),l(!1)},de=async()=>{if(!a||!S)return;l(!0);const{data:s,error:r}=await i.rpc("join_family_with_code",{_invite_code:S}),c=s;if(r||!(c!=null&&c.success)){t({variant:"destructive",title:"Ошибка присоединения",description:(c==null?void 0:c.error)||(r==null?void 0:r.message)||"Не удалось присоединиться к семье"}),l(!1);return}t({title:"Успешно присоединились к семье",description:"Теперь у вас есть доступ к данным семьи"}),A(""),await O(),l(!1)},oe=async()=>{if(!a)return;l(!0);const{error:s}=await i.from("profiles").upsert({user_id:a.id,full_name:I},{onConflict:"user_id"});t(s?{variant:"destructive",title:"Ошибка сохранения",description:s.message}:{title:"Профиль обновлен",description:"Изменения успешно сохранены"}),l(!1)},me=s=>{ae(s),localStorage.setItem("currency",s),window.dispatchEvent(new Event("currencyChange")),t({title:"Валюта изменена",description:`Основная валюта: ${s}`})},ue=async()=>{if(!_||!T){t({variant:"destructive",title:"Ошибка",description:"Заполните все поля"});return}if(_!==T){t({variant:"destructive",title:"Ошибка",description:"Пароли не совпадают"});return}if(_.length<6){t({variant:"destructive",title:"Ошибка",description:"Пароль должен содержать минимум 6 символов"});return}l(!0);const{error:s}=await i.auth.updateUser({password:_});s?t({variant:"destructive",title:"Ошибка смены пароля",description:s.message}):(t({title:"Пароль изменен",description:"Ваш пароль успешно обновлен"}),W(""),G("")),l(!1)},xe=async s=>{if(!n)return;l(!0);const{error:r}=await i.from("family_members").delete().eq("family_id",n.id).eq("user_id",s);r?t({variant:"destructive",title:"Ошибка удаления",description:r.message}):(t({title:"Член семьи удален",description:"Пользователь больше не имеет доступа к данным семьи"}),await U(n.id)),l(!1)},he=async()=>{if(!n||!a)return;l(!0);const{error:s}=await i.from("family_members").delete().eq("family_id",n.id).eq("user_id",a.id);s?t({variant:"destructive",title:"Ошибка выхода",description:s.message}):(t({title:"Вы покинули семью",description:"Доступ к данным семьи закрыт"}),b(null),z([])),l(!1)},fe=async()=>{if(a){l(!0);try{const s=await i.from("income_sources").select("*").eq("user_id",a.id),r=await i.from("categories").select("*").eq("user_id",a.id),c=await i.from("incomes").select("*").eq("user_id",a.id),N=await i.from("expenses").select("*").eq("user_id",a.id),u=s.data,L=r.data,k=c.data,we=N.data,_e={exportDate:new Date().toISOString(),incomeSources:u||[],categories:L||[],incomes:k||[],expenses:we||[]},Ne=new Blob([JSON.stringify(_e,null,2)],{type:"application/json"}),Q=URL.createObjectURL(Ne),C=document.createElement("a");C.href=Q,C.download=`crystal-budget-export-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(C),C.click(),document.body.removeChild(C),URL.revokeObjectURL(Q),t({title:"Данные экспортированы",description:"Файл сохранен в папку загрузок"})}catch(s){t({variant:"destructive",title:"Ошибка экспорта",description:s.message})}l(!1)}},pe=async()=>{if(a&&confirm("Вы уверены? Все ваши данные будут удалены безвозвратно!")&&confirm("Это действие нельзя отменить. Продолжить?")){l(!0);try{await i.from("expenses").delete().eq("user_id",a.id),await i.from("incomes").delete().eq("user_id",a.id),await i.from("categories").delete().eq("user_id",a.id),await i.from("income_sources").delete().eq("user_id",a.id),t({title:"Данные очищены",description:"Все ваши финансовые данные удалены"})}catch(s){t({variant:"destructive",title:"Ошибка очистки",description:s.message})}l(!1)}},je=async()=>{if(!a||!M)return;l(!0);const{data:s,error:r}=await i.from("telegram_auth_codes").select("*").eq("auth_code",M).eq("used",!1).gt("expires_at",new Date().toISOString()).maybeSingle();if(r||!s){t({variant:"destructive",title:"Ошибка",description:"Неверный или истекший код"}),l(!1);return}const{error:c}=await i.from("telegram_users").insert({user_id:a.id,telegram_id:s.telegram_id,telegram_username:s.telegram_username,telegram_first_name:s.telegram_first_name,telegram_last_name:s.telegram_last_name});if(c){t({variant:"destructive",title:"Ошибка связывания",description:c.message}),l(!1);return}await i.from("telegram_auth_codes").update({used:!0}).eq("id",s.id);try{await i.functions.invoke("send-telegram-notification")}catch(N){console.error("Failed to send Telegram notification:",N)}t({title:"Telegram связан",description:"Теперь вы можете управлять бюджетом через Telegram. Проверьте бота!"}),J(""),await K(),l(!1)},ge=async()=>{if(!a)return;l(!0);const{error:s}=await i.from("telegram_users").delete().eq("user_id",a.id);s?t({variant:"destructive",title:"Ошибка",description:s.message}):(t({title:"Telegram отключен",description:"Связь с Telegram удалена"}),H(!1),V("")),l(!1)},ye=async()=>{$(!0);try{const{data:s,error:r}=await i.functions.invoke("set-telegram-webhook");if(r)throw r;if(s.success)t({title:"Webhook установлен",description:"Бот готов к работе"});else throw new Error(s.error||"Неизвестная ошибка")}catch(s){t({variant:"destructive",title:"Ошибка установки webhook",description:s.message})}$(!1)},ve=async()=>{const{error:s}=await i.auth.signOut();s?t({variant:"destructive",title:"Ошибка выхода",description:s.message}):(t({title:"Вы вышли из системы",description:"До встречи!"}),ee("/auth"))};return e.jsx(qe,{selectedDate:new Date,onDateChange:()=>{},showMonthSelector:!1,children:e.jsxs("div",{className:"space-y-6 max-w-2xl",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Настройки"}),e.jsx("p",{className:"text-muted-foreground",children:"Управление приложением и персонализация"})]}),e.jsxs(f,{children:[e.jsxs(p,{children:[e.jsx(j,{children:"Профиль"}),e.jsx(g,{children:"Персональная информация"})]}),e.jsxs(y,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{htmlFor:"email",children:"Email"}),e.jsx(v,{id:"email",value:(a==null?void 0:a.email)||"",disabled:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{htmlFor:"fullName",children:"Имя"}),e.jsx(v,{id:"fullName",value:I,onChange:s=>B(s.target.value),placeholder:"Введите ваше имя"})]}),e.jsx(d,{onClick:oe,disabled:o,children:o?"Сохранение...":"Сохранить изменения"})]})]}),e.jsxs(f,{children:[e.jsxs(p,{children:[e.jsx(j,{children:"Безопасность"}),e.jsx(g,{children:"Смена пароля"})]}),e.jsxs(y,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{htmlFor:"newPassword",children:"Новый пароль"}),e.jsx(v,{id:"newPassword",type:"password",value:_,onChange:s=>W(s.target.value),placeholder:"Введите новый пароль"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{htmlFor:"confirmPassword",children:"Подтвердите пароль"}),e.jsx(v,{id:"confirmPassword",type:"password",value:T,onChange:s=>G(s.target.value),placeholder:"Повторите новый пароль"})]}),e.jsx(d,{onClick:ue,disabled:o||!_||!T,children:o?"Изменение...":"Изменить пароль"})]})]}),e.jsxs(f,{children:[e.jsxs(p,{children:[e.jsx(j,{children:"Тема оформления"}),e.jsx(g,{children:"Выберите тему интерфейса"})]}),e.jsx(y,{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsxs(d,{variant:D==="light"?"default":"outline",onClick:()=>F("light"),className:"flex flex-col items-center gap-2 h-auto py-3",children:[e.jsx(Ee,{className:"h-5 w-5"}),e.jsx("span",{className:"text-xs",children:"Светлая"})]}),e.jsxs(d,{variant:D==="dark"?"default":"outline",onClick:()=>F("dark"),className:"flex flex-col items-center gap-2 h-auto py-3",children:[e.jsx(Re,{className:"h-5 w-5"}),e.jsx("span",{className:"text-xs",children:"Темная"})]}),e.jsxs(d,{variant:D==="system"?"default":"outline",onClick:()=>F("system"),className:"flex flex-col items-center gap-2 h-auto py-3",children:[e.jsx(Pe,{className:"h-5 w-5"}),e.jsx("span",{className:"text-xs",children:"Системная"})]})]})})]}),e.jsxs(f,{children:[e.jsxs(p,{children:[e.jsx(j,{children:"Валюта"}),e.jsx(g,{children:"Настройка отображения валюты"})]}),e.jsx(y,{className:"space-y-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{htmlFor:"currency",children:"Основная валюта"}),e.jsxs(Te,{value:se,onValueChange:me,children:[e.jsx(Me,{id:"currency",children:e.jsx(Ue,{})}),e.jsxs(Le,{children:[e.jsx(h,{value:"RUB",children:"RUB (₽)"}),e.jsx(h,{value:"USD",children:"USD ($)"}),e.jsx(h,{value:"EUR",children:"EUR (€)"}),e.jsx(h,{value:"GBP",children:"GBP (£)"}),e.jsx(h,{value:"JPY",children:"JPY (¥)"}),e.jsx(h,{value:"CNY",children:"CNY (¥)"}),e.jsx(h,{value:"KRW",children:"KRW (₩)"}),e.jsx(h,{value:"GEL",children:"GEL (₾)"}),e.jsx(h,{value:"AMD",children:"AMD (֏)"})]})]})]})})]}),e.jsxs(f,{children:[e.jsxs(p,{children:[e.jsx(j,{children:"Telegram"}),e.jsx(g,{children:"Управляйте бюджетом через Telegram бота"})]}),e.jsx(y,{className:"space-y-4",children:ie?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"p-3 border rounded-lg bg-muted/30",children:[e.jsx("p",{className:"text-sm font-medium",children:"✅ Telegram подключен"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["@",re]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Теперь вы можете использовать команды бота:"}),e.jsxs("ul",{className:"text-sm text-muted-foreground space-y-1 list-disc list-inside",children:[e.jsx("li",{children:"/expense [сумма] [категория] [описание]"}),e.jsx("li",{children:"/income [сумма] [источник] [описание]"}),e.jsx("li",{children:"/help - помощь"})]})]}),e.jsx(d,{onClick:ge,disabled:o,variant:"destructive",className:"w-full",children:"Отключить Telegram"})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2 p-3 border rounded-lg bg-muted/30",children:[e.jsx("p",{className:"text-sm font-medium",children:"Шаг 1: Настройка бота"}),e.jsx(d,{onClick:ye,disabled:Y,variant:"outline",className:"w-full",children:Y?"Настройка...":"Установить webhook"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Нажмите эту кнопку один раз для настройки бота"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm font-medium",children:"Шаг 2: Связывание аккаунта"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["1. Откройте бота ",e.jsx("a",{href:"https://t.me/crystalbudget_bot",target:"_blank",rel:"noopener noreferrer",className:"text-primary underline",children:"@crystalbudget_bot"})," в Telegram"]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"2. Отправьте команду /start"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"3. Введите полученный код ниже"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{htmlFor:"telegramCode",children:"Код авторизации"}),e.jsx(v,{id:"telegramCode",value:M,onChange:s=>J(s.target.value),placeholder:"Введите код из Telegram"})]}),e.jsx(d,{onClick:je,disabled:o||!M,className:"w-full",children:o?"Подключение...":"Связать с Telegram"})]})})]}),e.jsxs(f,{children:[e.jsxs(p,{children:[e.jsx(j,{children:"Семья"}),e.jsx(g,{children:"Управление доступом к финансам семьи"})]}),e.jsxs(y,{className:"space-y-4",children:[!n&&e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{children:[e.jsxs(d,{onClick:ne,disabled:o,className:"w-full",children:[e.jsx(Ie,{className:"mr-2 h-4 w-4"}),"Создать семью"]}),e.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:"Создайте семью, чтобы делиться доступом к финансам"})]})}),!n&&e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-0 flex items-center",children:e.jsx("span",{className:"w-full border-t"})}),e.jsx("div",{className:"relative flex justify-center text-xs uppercase",children:e.jsx("span",{className:"bg-background px-2 text-muted-foreground",children:"или"})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{htmlFor:"joinCode",children:"Присоединиться к семье"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(v,{id:"joinCode",value:S,onChange:s=>A(s.target.value.toUpperCase()),placeholder:"Введите код приглашения",maxLength:8}),e.jsx(d,{onClick:de,disabled:o||!S,children:e.jsx(Oe,{className:"h-4 w-4"})})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Введите код от владельца семьи"})]}),n&&e.jsxs("div",{className:"space-y-4",children:[n.owner_id===(a==null?void 0:a.id)?e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{htmlFor:"familyName",children:"Название семьи"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(v,{id:"familyName",value:q,onChange:s=>R(s.target.value),placeholder:"Название семьи"}),e.jsx(d,{onClick:ce,disabled:o||q===n.name,children:"Сохранить"})]})]}):e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Название семьи"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:n.name})]}),n.owner_id===(a==null?void 0:a.id)&&e.jsxs("div",{className:"space-y-3",children:[e.jsx(x,{children:"Код приглашения"}),E.length>0?e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex gap-2 items-center p-3 border rounded-lg bg-muted/30",children:[e.jsx(v,{value:E[0].code,readOnly:!0,className:"flex-1 font-mono text-lg text-center"}),e.jsx(d,{size:"sm",onClick:()=>{navigator.clipboard.writeText(E[0].code),t({title:"Код скопирован"})},variant:"outline",children:e.jsx(Fe,{className:"h-4 w-4"})})]}),e.jsx(d,{onClick:Z,disabled:o,variant:"outline",className:"w-full",children:"Сгенерировать новый код"})]}):e.jsx(d,{onClick:Z,disabled:o,className:"w-full",children:"Сгенерировать код"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Код действителен 5 минут и может быть использован один раз"})]}),n.owner_id!==(a==null?void 0:a.id)&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"p-3 border rounded-lg bg-muted/30",children:e.jsx("p",{className:"text-sm text-muted-foreground",children:"Вы являетесь членом этой семьи"})}),e.jsxs(d,{onClick:he,disabled:o,variant:"destructive",className:"w-full",children:[e.jsx(X,{className:"mr-2 h-4 w-4"}),"Покинуть семью"]})]}),P.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs(x,{children:["Члены семьи (",P.length,")"]}),e.jsx("div",{className:"space-y-2",children:P.map(s=>e.jsxs("div",{className:"text-sm p-3 border rounded-lg flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"h-8 w-8 rounded-full bg-primary/10 flex items-center justify-center",children:e.jsx("span",{className:"text-xs font-semibold text-primary",children:s.full_name.charAt(0).toUpperCase()})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:s.full_name}),s.is_owner&&e.jsx("p",{className:"text-xs text-muted-foreground",children:"Владелец"}),s.joined_at&&e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Присоединился ",new Date(s.joined_at).toLocaleDateString("ru-RU")]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[s.user_id===(a==null?void 0:a.id)&&e.jsx("span",{className:"text-xs px-2 py-1 bg-primary/10 text-primary rounded",children:"Вы"}),n.owner_id===(a==null?void 0:a.id)&&!s.is_owner&&e.jsx(d,{size:"sm",variant:"ghost",onClick:()=>xe(s.user_id),disabled:o,children:e.jsx(De,{className:"h-4 w-4 text-destructive"})})]})]},s.user_id))})]})]})]})]}),e.jsxs(f,{children:[e.jsxs(p,{children:[e.jsx(j,{children:"Аккаунт"}),e.jsx(g,{children:"Управление вашим аккаунтом"})]}),e.jsx(y,{className:"space-y-4",children:e.jsxs(d,{onClick:ve,variant:"outline",className:"w-full",children:[e.jsx(X,{className:"mr-2 h-4 w-4"}),"Выйти из аккаунта"]})})]}),e.jsxs(f,{children:[e.jsxs(p,{children:[e.jsx(j,{children:"Данные"}),e.jsx(g,{children:"Управление вашими данными"})]}),e.jsxs(y,{className:"space-y-4",children:[e.jsx(d,{variant:"outline",className:"w-full",onClick:fe,disabled:o,children:o?"Экспортирую...":"Экспортировать данные"}),e.jsx(d,{variant:"destructive",className:"w-full",onClick:pe,disabled:o,children:o?"Очищаю...":"Очистить все данные"})]})]})]})})};export{Ve as default};
